countrycode == 1040 ~ "Austria",
countrycode == 1056 ~ "Belgium",
countrycode == 1100 ~ "Bulgaria",
countrycode == 1191 ~ "Croatia",
countrycode == 1196 ~ "Cyprus",
countrycode == 1203 ~ "Czech Rep.",
countrycode == 1208 ~ "Denmark",
countrycode == 1233 ~ "Estonia",
countrycode == 1246 ~ "Finland",
countrycode == 1250 ~ "France",
countrycode == 1276 ~ "Germany",
countrycode == 1300 ~ "Greece",
countrycode == 1348 ~ "Hungary",
countrycode == 1372 ~ "Ireland",
countrycode == 1380 ~ "Italy",
countrycode == 1428 ~ "Latvia",
countrycode == 1440 ~ "Lithuania",
countrycode == 1442 ~ "Luxembourg",
countrycode == 1470 ~ "Malta",
countrycode == 1528 ~ "Netherlands",
countrycode == 1616 ~ "Poland",
countrycode == 1620 ~ "Portugal",
countrycode == 1642 ~ "Romania",
countrycode == 1703 ~ "Slovakia",
countrycode == 1705 ~ "Slovenia",
countrycode == 1724 ~ "Spain",
countrycode == 1752 ~ "Sweden",
countrycode == 1826 ~ "United Kingdom",
TRUE ~ as.character(countrycode)
))
# ISO
d_2014$countrycode = countrycode(d_2014$countrycode, "country.name", "iso3c")
# mean
pol_int_2014 <- d_2014 %>%
group_by(countrycode) %>%
summarise(mean_pint = mean(qp6_9, na.rm = TRUE)) %>%
ungroup()
# uniform structure
pol_int_2014 <- pol_int_2014 %>%
rename(t_cntry = countrycode) %>%
mutate(t_ees = 2014)
# pol_int 2019
d_2019 = read_dta(here("Input", "data", "2019.dta")) %>%
clean_names() %>%
select(countrycode, q21) %>%
mutate(q21 = if_else(q21 > 4, NA_real_, q21))
# Country
d_2019 = d_2019 %>%
mutate(countrycode = case_when(
countrycode == 1040 ~ "Austria",
countrycode == 1056 ~ "Belgium",
countrycode == 1110 ~ "Bulgaria",
countrycode == 1191 ~ "Croatia",
countrycode == 1196 ~ "Cyprus",
countrycode == 1203 ~ "Czech Rep.",
countrycode == 1208 ~ "Denmark",
countrycode == 1233 ~ "Estonia",
countrycode == 1246 ~ "Finland",
countrycode == 1250 ~ "France",
countrycode == 1276 ~ "Germany",
countrycode == 1300 ~ "Greece",
countrycode == 1348 ~ "Hungary",
countrycode == 1372 ~ "Ireland",
countrycode == 1380 ~ "Italy",
countrycode == 1428 ~ "Latvia",
countrycode == 1440 ~ "Lithuania",
countrycode == 1442 ~ "Luxembourg",
countrycode == 1470 ~ "Malta",
countrycode == 1528 ~ "Netherlands",
countrycode == 1616 ~ "Poland",
countrycode == 1620 ~ "Portugal",
countrycode == 1642 ~ "Romania",
countrycode == 1703 ~ "Slovakia",
countrycode == 1705 ~ "Slovenia",
countrycode == 1724 ~ "Spain",
countrycode == 1752 ~ "Sweden",
countrycode == 1826 ~ "United Kingdom",
TRUE ~ as.character(countrycode)
))
# ISO
d_2019$countrycode = countrycode(d_2019$countrycode, "country.name", "iso3c")
# mean
pol_int_2019 <- d_2019 %>%
group_by(countrycode) %>%
summarise(mean_pint = mean(q21, na.rm = TRUE)) %>%
ungroup()
# uniform structure
pol_int_2019 <- pol_int_2019 %>%
rename(t_cntry = countrycode) %>%
mutate(t_ees = 2019)
# gather pint
pint <- bind_rows(pol_int, pol_int_2009, pol_int_2014, pol_int_2019)
# invert polarity
pint <- pint %>%
mutate(mean_pint = 5 - mean_pint)
#long
pint_long = pint %>%
rename(country = t_cntry,
year = t_ees,
pint = mean_pint) %>%
mutate(year = as.integer(year),
country_year = paste(country, year, sep = "_")) %>%
select(country, year, country_year, pint) %>%
na.omit()
# load and filter
vdem = vdem %>%
filter(country_text_id %in% unique_countries$country,
year == "1989" |
year == "1994" |
year == "1999" |
year == "2004" |
year == "2009" |
year == "2014" |
year == "2019")
# Party institutionalization
#1: ideological coherence
#1.1: legislative party cohesion
vdem$v2pscohesv
#1.2: distinct party platform
vdem$v2psplats
#2: connection with constituencies
#2.1: party linkages
vdem$v2psprlnks
#3: organizational capacities
#3.1: party organization
vdem$v2psorgs
#3.2: party branches
vdem$v2psprbrch
#put in a single dataframe
p_inst = vdem %>%
select(country_text_id, year, v2pscohesv, v2psplats, v2psprlnks, v2psorgs, v2psprbrch)
#mean and sum score
p_inst = p_inst %>%
mutate(ido_coh = (v2pscohesv + v2psplats)/2,
org_cap = (v2psorgs + v2psprbrch)/2,
p_inst = (ido_coh + org_cap + v2psprlnks)/3)
#PCA to validate index
cfa_p_inst = p_inst %>%
select(ido_coh, org_cap, v2psprlnks)
# their cor
cor_p_inst = cor(cfa_p_inst)
#model
model = 'Factor1 =~ ido_coh + org_cap + v2psprlnks'
fit = cfa(model, data = cfa_p_inst, std.lv = TRUE)
summary(fit, fit.measures= TRUE)
#alpha
alpha = cronbach.alpha(cfa_p_inst)
#very good fit (cfi = 1; rmesea = 0)
#very good loadings (0.424, 0.554, 0.689)
#alpha 0.777
p_inst = p_inst %>%
dplyr::select(country_text_id, year, p_inst)
#long
p_inst_k_long = p_inst %>%
rename(country = country_text_id,
p_inst_k = p_inst) %>%
mutate(year = as.integer(year),
country_year = paste(country, year, sep = "_")) %>%
select(country, year, country_year, p_inst_k)
#ready made index
p_inst_index = vdem %>%
filter(country_text_id %in% unique_countries$country,
year == "1989" |
year == "1994" |
year == "1999" |
year == "2004" |
year == "2009" |
year == "2014" |
year == "2019") %>%
dplyr::select(country_text_id, year, v2xps_party)
#long
p_inst_long = p_inst_index %>%
rename(country = country_text_id,
p_inst = v2xps_party) %>%
mutate(year = as.integer(year),
country_year = paste(country, year, sep = "_")) %>%
select(country, year, country_year, p_inst)
alt_inf = vdem %>%
filter(country_text_id %in% unique_countries$country,
year == "1989" |
year == "1994" |
year == "1999" |
year == "2004" |
year == "2009" |
year == "2014" |
year == "2019") %>%
dplyr::select(country_text_id, year, v2xme_altinf)
#long
alt_inf_long = alt_inf %>%
rename(country = country_text_id,
alt_inf = v2xme_altinf) %>%
mutate(year = as.integer(year),
country_year = paste(country, year, sep = "_")) %>%
select(country, year, country_year, alt_inf)
ideol = vdem %>%
filter(country_text_id %in% unique_countries$country,
year == "1989" |
year == "1994" |
year == "1999" |
year == "2004" |
year == "2009" |
year == "2014" |
year == "2019") %>%
dplyr::select(country_text_id, year, v2exl_legitideol)
#long
ideol_long = ideol %>%
rename(country = country_text_id,
ideol = v2exl_legitideol) %>%
mutate(year = as.integer(year),
country_year = paste(country, year, sep = "_")) %>%
select(country, year, country_year, ideol)
pola = vdem %>%
filter(country_text_id %in% unique_countries$country,
year == "1989" |
year == "1994" |
year == "1999" |
year == "2004" |
year == "2009" |
year == "2014" |
year == "2019") %>%
dplyr::select(country_text_id, year, v2cacamps)
#long
pola_long = pola %>%
rename(country = country_text_id,
pola = v2cacamps) %>%
mutate(year = as.integer(year),
country_year = paste(country, year, sep = "_")) %>%
select(country, year, country_year, pola)
mass_mob = vdem %>%
filter(country_text_id %in% unique_countries$country,
year == "1989" |
year == "1994" |
year == "1999" |
year == "2004" |
year == "2009" |
year == "2014" |
year == "2019") %>%
dplyr::select(country_text_id, year, v2cagenmob)
#long
mass_mob_long = mass_mob %>%
rename(country = country_text_id,
mass_mob = v2cagenmob) %>%
mutate(year = as.integer(year),
country_year = paste(country, year, sep = "_")) %>%
select(country, year, country_year, mass_mob)
#save individual df
saveRDS(age_d_long, here("Input", "final_data", "IV", "age_d_long.rds"))
saveRDS(alt_inf_long, here("Input", "final_data", "IV", "alt_inf_long.rds"))
saveRDS(educ_long, here("Input", "final_data", "IV", "educ_long.rds"))
saveRDS(ENEP_gallagher_long, here("Input", "final_data", "IV", "ENEP_gallagher_long.rds"))
#save individual df
saveRDS(age_d_long, here("Input", "final_data", "IV", "age_d_long.rds"))
saveRDS(alt_inf_long, here("Input", "final_data", "IV", "alt_inf_long.rds"))
saveRDS(educ_long, here("Input", "final_data", "IV", "educ_long.rds"))
saveRDS(ideol_long, here("Input", "final_data", "IV", "ideol_long.rds"))
saveRDS(mass_mob_long, here("Input", "final_data", "IV", "mass_mob_long.rds"))
saveRDS(p_inst_k_long, here("Input", "final_data", "IV", "p_inst_k_long.rds"))
saveRDS(p_inst_long, here("Input", "final_data", "IV", "p_inst_long.rds"))
saveRDS(pint_long, here("Input", "final_data", "IV", "pint_long.rds"))
saveRDS(pola_long, here("Input", "final_data", "IV", "pola_long.rds"))
saveRDS(turnout_long, here("Input", "final_data", "IV", "turnout_long.rds"))
saveRDS(IHDI_long, here("Input", "final_data", "IV", "IHDI_long.rds"))
saveRDS(ENEP_long, here("Input", "final_data", "IV", "ENEP_long.rds"))
saveRDS(gallagher_long, here("Input", "final_data", "IV", "gallagher_long.rds"))
# import DV
DV = read_rds(here("Input", "final_data", "DV.rds"))
#import IVs
age_d = read_rds(here("Input", "final_data", "IV", "age_d_long.rds"))
alt_inf = read_rds(here("Input", "final_data", "IV", "alt_inf_long.rds"))
educ = read_rds(here("Input", "final_data", "IV", "educ_long.rds"))
ideol = read_rds(here("Input", "final_data", "IV", "ideol_long.rds"))
mass_mob = read_rds(here("Input", "final_data", "IV", "mass_mob_long.rds"))
p_inst_k = read_rds(here("Input", "final_data", "IV", "p_inst_k_long.rds"))
p_inst = read_rds(here("Input", "final_data", "IV", "p_inst_long.rds"))
pint = read_rds(here("Input", "final_data", "IV", "pint_long.rds"))
pola = read_rds(here("Input", "final_data", "IV", "pola_long.rds"))
turnout = read_rds(here("Input", "final_data", "IV", "turnout_long.rds"))
IHDI = read_rds(here("Input", "final_data", "IV", "IHDI_long.rds"))
ENEP = read_rds(here("Input", "final_data", "IV", "ENEP_long.rds"))
gallagher = read_rds(here("Input", "final_data", "IV", "gallagher_long.rds"))
# select cor Vs
cor_df = DV %>%
select(country,year,country_year,EES_COR_aspl,EES_COR_constraint,EES_COR_np_i,
EES_COR_np_w,EES_CCA,EES_EGA)
# means for belgium
cor_df <- cor_df %>%
group_by(country_year) %>%
summarise(across(where(is.numeric), mean, na.rm = TRUE),
across(where(is.character), first)) %>%
select(country, year, country_year, EES_COR_aspl,EES_COR_constraint,EES_COR_np_i,
EES_COR_np_w,EES_CCA,EES_EGA)
data_frames <- list(age_d, alt_inf, educ, ideol, mass_mob, p_inst, p_inst_k, pint,
pola, turnout, IHDI,ENEP, gallagher)
# Initialize final_data, list of dfs
final_cor <- cor_df
View(cor_df)
View(age_d)
View(age_d)
View(alt_inf)
View(cor_df)
View(educ)
View(ENEP)
View(final_cor)
View(gallagher)
View(ideol)
View(IHDI)
View(mass_mob)
View(p_inst)
View(p_inst_k)
View(pint)
View(pola)
View(turnout)
for(df in data_frames) {
# Extract the name of the fourth column
col_name <- names(df)[4]
# Merge
final_cor <- merge(final_cor, df[, c("country_year", col_name)], by = "country_year", all.x = TRUE)
}
View(final_cor)
# manually adjust 0 for DEU 1989 in age_d
final_cor[23,10] = 0
rows_with_problems <- final_cor %>%
filter(if_any(everything(), ~is.na(.x) | is.nan(.x) | is.infinite(.x)))
View(age_d)
library("pacman")
p_load(tidyverse, here, haven, countrycode, vdemdata, psych, lavaan, ltm,
janitor, conflicted)
#conflicts
conflict_prefer("select", "dplyr")
conflict_prefer("filter", "dplyr")
# import DV
DV = read_rds(here("Input", "final_data", "DV.rds"))
#import IVs
age_d = read_rds(here("Input", "final_data", "IV", "age_d_long.rds"))
alt_inf = read_rds(here("Input", "final_data", "IV", "alt_inf_long.rds"))
educ = read_rds(here("Input", "final_data", "IV", "educ_long.rds"))
ideol = read_rds(here("Input", "final_data", "IV", "ideol_long.rds"))
mass_mob = read_rds(here("Input", "final_data", "IV", "mass_mob_long.rds"))
p_inst_k = read_rds(here("Input", "final_data", "IV", "p_inst_k_long.rds"))
p_inst = read_rds(here("Input", "final_data", "IV", "p_inst_long.rds"))
pint = read_rds(here("Input", "final_data", "IV", "pint_long.rds"))
pola = read_rds(here("Input", "final_data", "IV", "pola_long.rds"))
turnout = read_rds(here("Input", "final_data", "IV", "turnout_long.rds"))
IHDI = read_rds(here("Input", "final_data", "IV", "IHDI_long.rds"))
ENEP = read_rds(here("Input", "final_data", "IV", "ENEP_long.rds"))
gallagher = read_rds(here("Input", "final_data", "IV", "gallagher_long.rds"))
# select cor Vs
cor_df = DV %>%
select(country,year,country_year,EES_COR_aspl,EES_COR_constraint,EES_COR_np_i,
EES_COR_np_w,EES_CCA,EES_EGA)
# means for belgium
cor_df <- cor_df %>%
group_by(country_year) %>%
summarise(across(where(is.numeric), mean, na.rm = TRUE),
across(where(is.character), first)) %>%
select(country, year, country_year, EES_COR_aspl,EES_COR_constraint,EES_COR_np_i,
EES_COR_np_w,EES_CCA,EES_EGA)
#merge
# Initialize final_data, list of dfs
final_cor <- cor_df
data_frames <- list(age_d, alt_inf, educ, ideol, mass_mob, p_inst, p_inst_k, pint,
pola, turnout, IHDI,ENEP, gallagher)
# Loop t
for(df in data_frames) {
# Extract the name of the fourth column
col_name <- names(df)[4]
# Merge
final_cor <- merge(final_cor, df[, c("country_year", col_name)], by = "country_year", all.x = TRUE)
}
# manually adjust 0 for DEU 1989 in age_d
final_cor[23,10] = 0
rows_with_problems <- final_cor %>%
filter(if_any(everything(), ~is.na(.x) | is.nan(.x) | is.infinite(.x)))
View(final_cor)
View(DV)
names(DV)
# select cor Vs
pcor_df = DV %>%
select(country,year,country_year,EES_GGM_glasso_aspl,EES_GGM_glasso_constraint,
EES_GGM_glasso_np_i,EES_GGM_glasso_np_w,EES_GGM_huge_aspl,EES_GGM_huge_constraint,
EES_GGM_huge_np_i,EES_GGM_huge_np_w,EES_CCA,EES_EGA)
View(pcor_df)
pcor_df <- pcor_df %>%
slice(-10)
pcor_df <- pcor_df %>%
group_by(country_year) %>%
summarise(across(where(is.numeric), mean, na.rm = TRUE),
across(where(is.character), first)) %>%
select(country,year,country_year,EES_GGM_glasso_aspl,EES_GGM_glasso_constraint,
EES_GGM_glasso_np_i,EES_GGM_glasso_np_w,EES_GGM_huge_aspl,EES_GGM_huge_constraint,
EES_GGM_huge_np_i,EES_GGM_huge_np_w,EES_CCA,EES_EGA)
#merge
# Initialize final_data, list of dfs
final_pcor <- pcor_df
data_frames <- list(age_d, alt_inf, educ, ideol, mass_mob, p_inst, p_inst_k, pint,
pola, turnout,IHDI,ENEP, gallagher)
# Loop t
for(df in data_frames) {
# Extract the name of the fourth column
col_name <- names(df)[4]
# Merge
final_pcor <- merge(final_pcor, df[, c("country_year", col_name)], by = "country_year", all.x = TRUE)
}
View(final_pcor)
#isolate problems
rows_with_problems <- final_pcor %>%
filter(if_any(everything(), ~is.na(.x) | is.nan(.x) | is.infinite(.x)))
rows_with_problems
names(final_pcor)
final_pcor[23,14]
final_pcor[23,14] = 0
rows_with_problems <- final_pcor %>%
filter(if_any(everything(), ~is.na(.x) | is.nan(.x) | is.infinite(.x)))
rows_with_problems
#final merge
final = final_pcor
names(final_cor)
names(final_pcor)
#final merge
final = final_pcor
final$EES_COR_aspl = final_cor$EES_COR_aspl
final$EES_COR_constraint = final_cor$EES_COR_constraint
final$EES_COR_np_i = final_cor$EES_COR_np_i
final$EES_COR_np_w = final_cor$EES_COR_np_w
View(final)
names(final)
saveRDS(final, here("Input", "final_data", "final.rds"))
library("pacman")
p_load(tidyverse, here, haven, countrycode, vdemdata, psych, lavaan, ltm,
janitor, conflicted)
#conflicts
conflict_prefer("select", "dplyr")
conflict_prefer("filter", "dplyr")
# import DV
DV = read_rds(here("Input", "final_data", "DV.rds"))
#import IVs
age_d = read_rds(here("Input", "final_data", "IV", "age_d_long.rds"))
alt_inf = read_rds(here("Input", "final_data", "IV", "alt_inf_long.rds"))
educ = read_rds(here("Input", "final_data", "IV", "educ_long.rds"))
ideol = read_rds(here("Input", "final_data", "IV", "ideol_long.rds"))
mass_mob = read_rds(here("Input", "final_data", "IV", "mass_mob_long.rds"))
p_inst_k = read_rds(here("Input", "final_data", "IV", "p_inst_k_long.rds"))
p_inst = read_rds(here("Input", "final_data", "IV", "p_inst_long.rds"))
pint = read_rds(here("Input", "final_data", "IV", "pint_long.rds"))
pola = read_rds(here("Input", "final_data", "IV", "pola_long.rds"))
turnout = read_rds(here("Input", "final_data", "IV", "turnout_long.rds"))
IHDI = read_rds(here("Input", "final_data", "IV", "IHDI_long.rds"))
ENEP = read_rds(here("Input", "final_data", "IV", "ENEP_long.rds"))
gallagher = read_rds(here("Input", "final_data", "IV", "gallagher_long.rds"))
# select cor Vs
cor_df = DV %>%
select(country,year,country_year,EES_COR_aspl,EES_COR_constraint,EES_COR_np_i,
EES_COR_np_w,EES_CCA,EES_EGA)
# means for belgium
cor_df <- cor_df %>%
group_by(country_year) %>%
summarise(across(where(is.numeric), mean, na.rm = TRUE),
across(where(is.character), first)) %>%
select(country, year, country_year, EES_COR_aspl,EES_COR_constraint,EES_COR_np_i,
EES_COR_np_w,EES_CCA,EES_EGA)
#merge
# Initialize final_data, list of dfs
final_cor <- cor_df
data_frames <- list(age_d, alt_inf, educ, ideol, mass_mob, p_inst, p_inst_k, pint,
pola, turnout, IHDI,ENEP, gallagher)
# Loop t
for(df in data_frames) {
# Extract the name of the fourth column
col_name <- names(df)[4]
# Merge
final_cor <- merge(final_cor, df[, c("country_year", col_name)], by = "country_year", all.x = TRUE)
}
# manually adjust 0 for DEU 1989 in age_d
final_cor[23,10] = 0
# select cor Vs
pcor_df = DV %>%
select(country,year,country_year,EES_GGM_glasso_aspl,EES_GGM_glasso_constraint,
EES_GGM_glasso_np_i,EES_GGM_glasso_np_w,EES_GGM_huge_aspl,EES_GGM_huge_constraint,
EES_GGM_huge_np_i,EES_GGM_huge_np_w,EES_CCA,EES_EGA)
#exclude BEL 1999 which is an empty network
pcor_df <- pcor_df %>%
slice(-10)
# means for belgium
pcor_df <- pcor_df %>%
group_by(country_year) %>%
summarise(across(where(is.numeric), mean, na.rm = TRUE),
across(where(is.character), first)) %>%
select(country,year,country_year,EES_GGM_glasso_aspl,EES_GGM_glasso_constraint,
EES_GGM_glasso_np_i,EES_GGM_glasso_np_w,EES_GGM_huge_aspl,EES_GGM_huge_constraint,
EES_GGM_huge_np_i,EES_GGM_huge_np_w,EES_CCA,EES_EGA)
#merge
# Initialize final_data, list of dfs
final_pcor <- pcor_df
data_frames <- list(age_d, alt_inf, educ, ideol, mass_mob, p_inst, p_inst_k, pint,
pola, turnout,IHDI,ENEP, gallagher)
# Loop t
for(df in data_frames) {
# Extract the name of the fourth column
col_name <- names(df)[4]
# Merge
final_pcor <- merge(final_pcor, df[, c("country_year", col_name)], by = "country_year", all.x = TRUE)
}
# manually adjust 0 for DEU 1989 in age_d
final_pcor[23,14] = 0
#final merge
final = final_pcor
final$EES_COR_aspl = final_cor$EES_COR_aspl
final$EES_COR_constraint = final_cor$EES_COR_constraint
final$EES_COR_np_i = final_cor$EES_COR_np_i
final$EES_COR_np_w = final_cor$EES_COR_np_w
saveRDS(final, here("Input", "final_data", "final.rds"))
View(final)
